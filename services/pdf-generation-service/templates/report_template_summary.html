<!DOCTYPE html>
<html>
<head>
    <title>Solar Report Summary - {{ report.project_name }}</title>
    <style>
        @page {
            size: A4;
            margin: 0.75in;
        }

        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
        }

        .header {
            text-align: center;
            border-bottom: 2px solid #2E8B57;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .header h1 {
            color: #2E8B57;
            font-size: 20pt;
            margin: 0;
            font-weight: bold;
        }

        .header .subtitle {
            color: #666;
            font-size: 12pt;
            margin: 5px 0 0 0;
        }

        .summary-grid {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }

        .summary-item {
            flex: 1;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .summary-value {
            font-size: 16pt;
            font-weight: bold;
            color: #2E8B57;
            margin-bottom: 5px;
        }

        .summary-label {
            font-size: 9pt;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .key-info {
            background: #fff8e1;
            border: 1px solid #ffe082;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .key-info h3 {
            color: #f57c00;
            margin-top: 0;
            font-size: 12pt;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
            font-size: 9pt;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Solar Energy Summary</h1>
        <div class="subtitle">{{ report.project_name }}</div>
    </div>

    <div class="summary-grid">
        <div class="summary-item">
            <div class="summary-value">{{ "%.0f" | format(report.net_annual_kwh) }}</div>
            <div class="summary-label">Annual Production (kWh)</div>
        </div>
        <div class="summary-item">
            <div class="summary-value">${{ "%.2f" | format(report.cost_usd) }}</div>
            <div class="summary-label">System Cost</div>
        </div>
        <div class="summary-item">
            <div class="summary-value">{{ "%.1f" | format(report.shading_loss_pct * 100) }}%</div>
            <div class="summary-label">Shading Loss</div>
        </div>
    </div>

    <div class="key-info">
        <h3>Key Information</h3>
        <p><strong>Project ID:</strong> {{ report.project_id }}</p>
        <p><strong>Location:</strong> {{ "%.4f" | format(report.location.lat) }}, {{ "%.4f" | format(report.location.lon) }}</p>
        <p><strong>Status:</strong> {{ report.status }}</p>
        <p><strong>Report Generated:</strong> {{ report.generation_date }}</p>
    </div>

    {% if report.include_financial and report.financial_data %}
    <div class="key-info">
        <h3>Financial Summary</h3>
        {% for key, value in report.financial_data.items() %}
        <p><strong>{{ key | replace('_', ' ') | title }}:</strong>
        {% if value is number %}
            {% if 'cost' in key.lower() or 'price' in key.lower() %}
                ${{ "%.2f" | format(value) }}
            {% else %}
                {{ "%.2f" | format(value) }}
            {% endif %}
        {% else %}
            {{ value }}
        {% endif %}
        </p>
        {% endfor %}
    </div>
    {% endif %}

    <div class="footer">
        <strong>Sol-Calc.com Solar Energy Summary Report</strong><br>
        Project ID: {{ report.project_id }}<br>
        <em>For detailed analysis, request the full report</em>
    </div>
</body>
</html>